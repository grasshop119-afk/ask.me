<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ask.me</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bodymovin/5.12.2/lottie.min.js"></script>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            background: #000; 
            color: #fff; 
            font-family: -apple-system, sans-serif; 
            min-height: 100vh; 
            padding-top: 80px; /* Опустили ниже */
        }
        .header { 
            position: fixed; 
            top: 0; 
            width: 100%; 
            background: #000; 
            padding: 24px 24px 20px; /* Больше padding сверху */
            z-index: 100; 
        }
        .logo { 
            font-family: 'Montserrat', sans-serif; 
            font-weight: 700; 
            font-size: 24px; 
            color: #fff; 
        }
        .logo-dot, .logo-me, .accent-color { 
            color: #007AFF; /* будет заменен на акцентный цвет Telegram */
        }
        .profile-container { 
            padding: 0 24px; 
            max-width: 480px; 
            margin-left: auto; 
            margin-right: auto; 
            display: flex;
            flex-direction: column;
            min-height: calc(100vh - 140px);
        }
        .profile-info { 
            display: flex; 
            align-items: center; 
            gap: 16px; 
            margin-bottom: 32px; 
        }
        .avatar-frame { 
            width: 72px; 
            height: 72px; 
            background: #2C2C2E; 
            border-radius: 50%; 
            flex-shrink: 0; 
            overflow: hidden; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
        }
        .avatar-frame img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        .user-info { 
            display: flex; 
            flex-direction: column; 
            gap: 2px; 
        }
        .user-name-container { 
            display: flex; 
            align-items: center; 
            gap: 8px; /* Чуть ближе галочка */
        }
        .user-name { 
            font-weight: 700; 
            font-size: 24px; 
        }
        .user-username { 
            font-size: 14px; 
            color: rgba(255,255,255,0.7); 
        }
        .verified-icon { 
            display: flex; 
            align-items: center; 
            justify-content: center; 
        }
        .verified-icon img { 
            width: 22px; 
            height: 22px; 
            filter: invert(36%) sepia(90%) saturate(2476%) hue-rotate(200deg) brightness(102%) contrast(101%); 
        }
        .divider {
            width: 100%;
            height: 1px;
            background: #333;
            margin-bottom: 20px;
        }
        .tabs {
            display: flex;
            margin-bottom: 32px;
        }
        .tab {
            flex: 1;
            text-align: center;
            padding: 12px 0;
            font-size: 16px;
            color: rgba(255,255,255,0.7);
            cursor: pointer;
            transition: color 0.2s;
        }
        .tab.active {
            color: #fff;
            /* Убрали font-weight: 500; */
        }
        .content-area {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            margin-top: -40px; /* Поднимаем контент в центр */
        }
        .content {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: rgba(255,255,255,0.5);
            font-size: 16px;
            text-align: center;
            min-height: 300px;
        }
        .sticker-container {
            width: 150px;
            height: 150px;
            margin-bottom: 20px;
        }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght=700&display=swap" rel="stylesheet">
</head>
<body>
    <header class="header"><div class="logo">ask<span class="logo-dot">.</span><span class="logo-me">me</span></div></header>
    <div class="profile-container">
        <div class="profile-info">
            <div class="avatar-frame" id="user-avatar">
                <!-- Аватар загрузится через Telegram Web App -->
            </div>
            <div class="user-info">
                <div class="user-name-container">
                    <div class="user-name" id="user-first-name">User</div>
                    <div class="verified-icon" id="verified-icon" style="display: none;">
                        <img src="https://img.icons8.com/?size=100&id=8jOLgduf9aBf&format=png&color=000000" alt="">
                    </div>
                </div>
                <div class="user-username" id="user-username">@user000</div>
            </div>
        </div>

        <div class="divider"></div>

        <div class="tabs">
            <div class="tab active" data-tab="ideas">Идеи</div>
            <div class="tab" data-tab="questions">Вопросы</div>
            <div class="tab" data-tab="answers">Ответы</div>
        </div>

        <div class="content-area">
            <div class="content" id="ideas-content">
                <div class="sticker-container" id="sticker-ideas"></div>
                Идей пока нет
            </div>
            <div class="content" id="questions-content" style="display: none;">
                <div class="sticker-container" id="sticker-questions"></div>
                Вопросов еще не задавали
            </div>
            <div class="content" id="answers-content" style="display: none;">
                <div class="sticker-container" id="sticker-answers"></div>
                <span id="answers-text">User пока не отвечал на вопросы</span>
            </div>
        </div>
    </div>

    <script>
        // Инициализация Telegram Web App
        let tg = window.Telegram.WebApp;
        
        // Расширяем Web App на всю высоту
        tg.expand();
        
        // Получаем акцентный цвет пользователя
        const accentColor = tg.themeParams.accent_color || '#007AFF';
        
        // Применяем акцентный цвет ко всем синим элементам
        document.querySelectorAll('.logo-dot, .logo-me, .accent-color').forEach(el => {
            el.style.color = accentColor;
        });
        
        // Применяем акцентный цвет к иконке галочки через фильтр
        function hexToFilter(hexColor) {
            // Преобразуем hex в RGB
            const r = parseInt(hexColor.slice(1, 3), 16);
            const g = parseInt(hexColor.slice(3, 5), 16);
            const b = parseInt(hexColor.slice(5, 7), 16);
            
            // Вычисляем фильтр для преобразования черного в нужный цвет
            // Это приблизительный расчет, может потребоваться точная настройка
            return `invert(${r/255*100}%) sepia(${g/255*100}%) saturate(${b/255*2476}%) hue-rotate(${hue}deg) brightness(${brightness}%) contrast(${contrast}%)`;
        }
        
        // Загружаем данные пользователя
        const user = tg.initDataUnsafe.user;
        if (user) {
            // Имя пользователя
            if (user.first_name) {
                document.getElementById('user-first-name').textContent = user.first_name;
            }
            
            // Юзернейм
            if (user.username) {
                document.getElementById('user-username').textContent = '@' + user.username;
                
                // Галочка только для @ya_admin7
                if (user.username === 'ya_admin7') {
                    document.getElementById('verified-icon').style.display = 'flex';
                    
                    // Применяем акцентный цвет к иконке
                    const iconImg = document.querySelector('.verified-icon img');
                    if (iconImg) {
                        iconImg.style.filter = `invert(36%) sepia(90%) saturate(2476%) hue-rotate(${getHueFromHex(accentColor)}deg) brightness(102%) contrast(101%)`;
                    }
                }
            }
            
            // Аватар
            if (user.photo_url) {
                const avatarImg = document.createElement('img');
                avatarImg.src = user.photo_url;
                avatarImg.alt = 'Avatar';
                document.getElementById('user-avatar').appendChild(avatarImg);
            }
            
            // Обновляем текст в ответах с именем пользователя
            const answersText = document.getElementById('answers-text');
            if (answersText && user.first_name) {
                answersText.textContent = `${user.first_name} пока не отвечал на вопросы`;
            }
        }
        
        // Вспомогательная функция для получения hue из hex цвета
        function getHueFromHex(hex) {
            const r = parseInt(hex.slice(1, 3), 16) / 255;
            const g = parseInt(hex.slice(3, 5), 16) / 255;
            const b = parseInt(hex.slice(5, 7), 16) / 255;
            
            const max = Math.max(r, g, b);
            const min = Math.min(r, g, b);
            let hue = 0;
            
            if (max === min) {
                hue = 0;
            } else {
                const d = max - min;
                switch (max) {
                    case r: hue = (g - b) / d + (g < b ? 6 : 0); break;
                    case g: hue = (b - r) / d + 2; break;
                    case b: hue = (r - g) / d + 4; break;
                }
                hue /= 6;
            }
            
            return Math.round(hue * 360);
        }
        
        // Загружаем стикеры
        function loadSticker(stickerId, containerId) {
            fetch('Stickers/Nothing.json')
                .then(response => response.json())
                .then(data => {
                    lottie.loadAnimation({
                        container: document.getElementById(containerId),
                        renderer: 'svg',
                        loop: true,
                        autoplay: true,
                        animationData: data
                    });
                })
                .catch(error => {
                    console.error('Ошибка загрузки стикера:', error);
                    document.getElementById(containerId).innerHTML = 
                        '<div style="color:rgba(255,255,255,0.3);text-align:center;padding:20px;">○</div>';
                });
        }
        
        // Загружаем стикеры для всех вкладок
        loadSticker('nothing', 'sticker-ideas');
        loadSticker('nothing', 'sticker-questions');
        loadSticker('nothing', 'sticker-answers');
        
        // Обработка вкладок
        const tabs = document.querySelectorAll('.tab');
        const contents = document.querySelectorAll('.content');
        
        tabs.forEach(tab => {
            tab.addEventListener('click', () => {
                // Вибрация в Telegram
                if (tg.isVersionAtLeast('6.1')) {
                    tg.HapticFeedback.impactOccurred('light');
                }
                
                // Смена вкладок
                tabs.forEach(t => t.classList.remove('active'));
                contents.forEach(c => c.style.display = 'none');
                
                tab.classList.add('active');
                
                const tabId = tab.getAttribute('data-tab');
                document.getElementById(`${tabId}-content`).style.display = 'flex';
            });
        });
    </script>
</body>
</html>
