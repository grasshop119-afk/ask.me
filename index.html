<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–†–µ–π—Ç–∏–Ω–≥ ‚Äî –ß–∏–±–∏–∫–∏</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bodymovin/5.12.2/lottie.min.js"></script>
    <style>
        * {
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
            box-sizing: border-box;
        }
        
        body {
            margin: 0;
            padding: 0;
            background: #000;
            color: white;
            font-family: -apple-system, BlinkMacSystemFont, sans-serif;
            overflow: hidden;
        }

        .header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 52px;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(20px);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 16px;
            z-index: 100;
            border-bottom: 0.5px solid #222;
        }

        .logo {
            height: 32px;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .user-avatar-container {
            position: relative;
            width: 40px;
            height: 40px;
            border-radius: 14px;
            border: 1.5px solid var(--accent-color, #007AFF);
            overflow: visible;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #000;
        }

        .user-avatar {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 12px;
        }

        .avatar-gif {
            position: absolute;
            bottom: -8px;
            right: -8px;
            width: 30px;
            height: 30px;
            z-index: 2;
            pointer-events: auto;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
        }

        .main-content {
            position: absolute;
            top: 52px;
            bottom: 0;
            left: 0;
            right: 0;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .top-section {
            flex-shrink: 0;
            padding: 30px 0 0 0;
            background: #000;
            position: relative;
            z-index: 10;
        }

        .sticker-container {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
        }

        .sticker-wrapper {
            width: 150px;
            height: 150px;
        }

        .title-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            margin-bottom: 20px;
        }

        .title {
            font-size: 24px;
            font-weight: 700;
            color: #FFFFFF;
        }

        .user-rank-badge {
            background: rgba(255, 255, 255, 0.1);
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 14px;
            font-weight: 600;
            opacity: 0.65;
            cursor: pointer;
            transition: all 0.2s ease;
            border: 1px solid rgba(255, 255, 255, 0.15);
        }

        .user-rank-badge:active {
            opacity: 1;
            transform: scale(0.95);
        }

        .rank-tooltip {
            position: absolute;
            top: 70px;
            left: 50%;
            transform: translateX(-50%);
            background: #1A1A1A;
            border-radius: 12px;
            padding: 12px 20px;
            font-size: 15px;
            font-weight: 500;
            color: #FFFFFF;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            z-index: 1000;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.4);
            transition: opacity 0.2s ease;
            border: 1px solid #222;
        }

        .rank-tooltip.show {
            opacity: 1;
        }

        .rank-tooltip::before {
            content: '';
            position: absolute;
            top: -6px;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 6px solid transparent;
            border-right: 6px solid transparent;
            border-bottom: 6px solid #1A1A1A;
        }

        .divider {
            width: 90%;
            height: 1px;
            background: #333;
            margin: 0 auto 20px auto;
        }

        .selector-container {
            display: flex;
            justify-content: center;
            gap: 40px;
            margin-bottom: 25px;
            align-items: center;
        }

        .selector-item {
            display: flex;
            align-items: center;
            gap: 8px;
            opacity: 0.5;
            cursor: pointer;
            transition: opacity 0.3s ease;
            padding: 8px 12px;
            border-radius: 20px;
        }

        .selector-item.active {
            opacity: 1;
            background: rgba(255, 255, 255, 0.1);
        }

        .selector-icon {
            width: 24px;
            height: 24px;
        }

        .selector-label {
            font-size: 16px;
            font-weight: 600;
            color: #FFFFFF;
        }

        .rating-container {
            flex: 1;
            position: relative;
            overflow: hidden;
            margin-top: 10px;
        }

        .rating-scroll-area {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
            padding: 0 16px 20px 16px;
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        .rating-scroll-area::-webkit-scrollbar {
            display: none;
        }

        .rating-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
            max-width: 500px;
            margin: 0 auto;
        }

        .rating-card {
            background: rgba(26, 26, 26, 0.9);
            border-radius: 27px;
            border: 1px solid #222;
            padding: 18px;
            display: flex;
            align-items: center;
            transition: all 0.15s ease;
            position: relative;
            cursor: pointer;
            backdrop-filter: blur(10px);
        }

        .rating-card:active {
            background: rgba(34, 34, 34, 0.9);
            transform: scale(0.98);
        }

        .position {
            font-size: 20px;
            font-weight: 700;
            color: var(--accent-color, #007AFF);
            width: 40px;
            text-align: center;
            flex-shrink: 0;
            text-shadow: 0 0 10px rgba(var(--accent-rgb, 0, 122, 255), 0.3);
        }

        .user-info {
            flex: 1;
            text-align: left;
            min-width: 0;
            margin-left: 16px;
        }

        .username {
            font-size: 17px;
            font-weight: 600;
            color: #FFFFFF;
            margin-bottom: 4px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .user-id {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.6);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .score {
            font-size: 18px;
            font-weight: 700;
            color: rgba(255, 255, 255, 0.95);
            display: flex;
            align-items: center;
            gap: 6px;
            flex-shrink: 0;
            padding-left: 16px;
            border-left: 1px solid rgba(255, 255, 255, 0.1);
            min-width: 90px;
            text-align: right;
        }

        .loading {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 200px;
            color: rgba(255, 255, 255, 0.7);
            gap: 10px;
        }

        .loading-wheel {
            width: 30px;
            height: 30px;
            border: 3px solid rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            border-top-color: rgba(255, 255, 255, 0.8);
            animation: spin 0.8s linear infinite;
        }

        .event-tooltip {
            position: absolute;
            top: 45px;
            right: -5px;
            background: #1A1A1A;
            border-radius: 8px;
            padding: 8px 12px;
            font-size: 14px;
            font-weight: 500;
            color: #FFFFFF;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            z-index: 1000;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        .event-tooltip.show {
            opacity: 1;
        }

        .event-tooltip::before {
            content: '';
            position: absolute;
            top: -6px;
            right: 12px;
            width: 0;
            height: 0;
            border-left: 6px solid transparent;
            border-right: 6px solid transparent;
            border-bottom: 6px solid #1A1A1A;
        }

        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: rgba(255, 255, 255, 0.5);
            font-size: 16px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .top-three .position {
            font-size: 22px;
            text-shadow: 0 0 15px rgba(var(--accent-rgb, 0, 122, 255), 0.5);
        }

        .top-three .username {
            font-size: 18px;
            font-weight: 700;
        }

        .top-three .score {
            font-size: 20px;
        }

        @media (max-width: 375px) {
            .rating-card {
                border-radius: 24px;
                padding: 16px;
            }
            
            .position {
                font-size: 18px;
                width: 35px;
            }
            
            .username {
                font-size: 16px;
            }
            
            .score {
                font-size: 16px;
                min-width: 80px;
            }
            
            .user-avatar-container {
                width: 38px;
                height: 38px;
                border-radius: 12px;
            }
            
            .avatar-gif {
                width: 26px;
                height: 26px;
                bottom: -7px;
                right: -7px;
            }
            
            .selector-container {
                gap: 30px;
            }
            
            .title {
                font-size: 22px;
            }
        }

        @media (max-width: 320px) {
            .rating-card {
                border-radius: 21px;
                padding: 14px;
            }
            
            .position {
                font-size: 16px;
                width: 30px;
            }
            
            .username {
                font-size: 15px;
            }
            
            .score {
                font-size: 15px;
                min-width: 70px;
            }
            
            .user-avatar-container {
                width: 36px;
                height: 36px;
                border-radius: 10px;
            }
            
            .avatar-gif {
                width: 24px;
                height: 24px;
                bottom: -6px;
                right: -6px;
            }
            
            .selector-container {
                gap: 20px;
            }
            
            .title {
                font-size: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="header" id="header">
        <img src="https://i.ibb.co/zTB331HR/image.png" alt="Chibeki" class="logo">
        <div class="header-right">
            <div class="user-avatar-container" id="userAvatarContainer">
                <div class="user-avatar" id="userAvatar"></div>
                <img src="" alt="" class="avatar-gif" id="avatarGif">
            </div>
            <div class="event-tooltip" id="eventTooltip">NewYear2026</div>
        </div>
    </div>

    <div class="main-content">
        <div class="top-section">
            <div class="sticker-container">
                <div class="sticker-wrapper" id="stickerContainer"></div>
            </div>
            
            <div class="title-container">
                <div class="title">–†–µ–π—Ç–∏–Ω–≥ –∏–≥—Ä–æ–∫–æ–≤</div>
                <div class="user-rank-badge" id="userRankBadge">#...</div>
            </div>
            
            <div class="rank-tooltip" id="rankTooltip">–¢—ã –Ω–∞ 0 –º–µ—Å—Ç–µ –≤ –æ–±—â–µ–º —Ä–µ–π—Ç–∏–Ω–≥–µ</div>
            
            <div class="divider"></div>
            
            <div class="selector-container" id="selectorContainer">
                <div class="selector-item active" data-type="coins">
                    <div class="selector-icon" id="coinsIcon"></div>
                    <div class="selector-label">–ö–æ–∏–Ω—ã</div>
                </div>
                <div class="selector-item" data-type="chibis">
                    <div class="selector-icon" id="chibisIcon"></div>
                    <div class="selector-label">–ß–∏–±–∏–∫–∏</div>
                </div>
            </div>
        </div>
        
        <div class="rating-container">
            <div class="rating-scroll-area" id="ratingScrollArea">
                <div class="rating-list" id="ratingList">
                    <div class="loading">
                        <div class="loading-wheel"></div>
                        <div>–ó–∞–≥—Ä—É–∂–∞–µ–º —Ä–µ–π—Ç–∏–Ω–≥...</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        let currentUserGif = '';
        let tooltipVisible = false;
        let currentRatingType = 'coins';
        let coinsData = [];
        let chibisData = [];
        let currentUserRank = 0;
        let rankTooltipVisible = false;
        
        const EXCLUDED_USERS = ['ya_admin7', 'tmkazavr'];

        function initTelegramApp() {
            tg.ready();
            tg.expand();
            tg.setHeaderColor('#000000');
            tg.setBackgroundColor('#000000');
            
            const accentColor = tg.themeParams.accent_text_color || '#007AFF';
            document.documentElement.style.setProperty('--accent-color', accentColor);
            
            const rgb = hexToRgb(accentColor);
            if (rgb) {
                document.documentElement.style.setProperty('--accent-rgb', `${rgb.r}, ${rgb.g}, ${rgb.b}`);
            }
            
            tg.BackButton.onClick(goBack);
            
            document.addEventListener('click', function(e) {
                const tooltip = document.getElementById('eventTooltip');
                const avatarContainer = document.getElementById('userAvatarContainer');
                const rankTooltip = document.getElementById('rankTooltip');
                const rankBadge = document.getElementById('userRankBadge');
                
                if (!avatarContainer.contains(e.target) && !tooltip.contains(e.target) && tooltipVisible) {
                    hideEventTooltip();
                }
                
                if (!rankBadge.contains(e.target) && !rankTooltip.contains(e.target) && rankTooltipVisible) {
                    hideRankTooltip();
                }
            });
            
            setupUserAvatar();
            loadStickers();
            setupSelector();
            setupRankBadge();
            loadAllRatingData();
        }

        function hexToRgb(hex) {
            const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
            return result ? {
                r: parseInt(result[1], 16),
                g: parseInt(result[2], 16),
                b: parseInt(result[3], 16)
            } : null;
        }

        function setupUserAvatar() {
            const user = tg.initDataUnsafe?.user;
            const avatarElement = document.getElementById('userAvatar');
            const gifElement = document.getElementById('avatarGif');
            const avatarContainer = document.getElementById('userAvatarContainer');
            
            if (user) {
                if (user.photo_url) {
                    avatarElement.innerHTML = `<img src="${user.photo_url}" alt="Avatar" style="width:100%;height:100%;object-fit:cover;border-radius:12px;">`;
                } else {
                    avatarElement.innerHTML = `<div style="width:100%;height:100%;display:flex;align-items:center;justify-content:center;font-size:16px;font-weight:600;color:#fff;border-radius:12px;background:var(--accent-color, #007AFF);">U</div>`;
                }
                
                const username = user.username || '';
                
                if (username.toLowerCase() === 'temkazavr') {
                    currentUserGif = 'https://stickers.fullyst.com/e7e72911-670d-5946-93e4-3a32dfc3bdbd/full/AgADpWUAAhchkEo.webp';
                } else if (username.toLowerCase() === 'ribapibaa') {
                    currentUserGif = 'https://telepot.ru/images/stickers_img/652a5ce136.gif';
                } else {
                    currentUserGif = 'https://stickers.fullyst.com/0f72a8b7-c353-5e21-9e25-cbaa1f8b8a68/full/AgAD4SIAAm86EEk.webp';
                }
                
                gifElement.src = currentUserGif;
                
                avatarContainer.addEventListener('click', function(e) {
                    e.stopPropagation();
                    toggleEventTooltip();
                });
                
                gifElement.addEventListener('click', function(e) {
                    e.stopPropagation();
                    toggleEventTooltip();
                });
            } else {
                avatarElement.innerHTML = `<div style="width:100%;height:100%;display:flex;align-items:center;justify-content:center;font-size:16px;font-weight:600;color:#fff;border-radius:12px;background:var(--accent-color, #007AFF);">U</div>`;
                currentUserGif = 'https://stickers.fullyst.com/0f72a8b7-c353-5e21-9e25-cbaa1f8b8a68/full/AgAD4SIAAm86EEk.webp';
                gifElement.src = currentUserGif;
                
                avatarContainer.addEventListener('click', function(e) {
                    e.stopPropagation();
                    toggleEventTooltip();
                });
                
                gifElement.addEventListener('click', function(e) {
                    e.stopPropagation();
                    toggleEventTooltip();
                });
            }
        }

        function setupRankBadge() {
            const rankBadge = document.getElementById('userRankBadge');
            const rankTooltip = document.getElementById('rankTooltip');
            
            rankBadge.addEventListener('click', function(e) {
                e.stopPropagation();
                toggleRankTooltip();
            });
        }

        function toggleRankTooltip() {
            const rankTooltip = document.getElementById('rankTooltip');
            
            if (rankTooltipVisible) {
                hideRankTooltip();
            } else {
                rankTooltip.classList.add('show');
                rankTooltipVisible = true;
                
                setTimeout(() => {
                    hideRankTooltip();
                }, 3000);
            }
        }

        function hideRankTooltip() {
            const rankTooltip = document.getElementById('rankTooltip');
            rankTooltip.classList.remove('show');
            rankTooltipVisible = false;
        }

        function toggleEventTooltip() {
            const tooltip = document.getElementById('eventTooltip');
            
            if (tooltipVisible) {
                hideEventTooltip();
            } else {
                tooltip.classList.add('show');
                tooltipVisible = true;
                
                setTimeout(() => {
                    hideEventTooltip();
                }, 3000);
            }
        }

        function hideEventTooltip() {
            const tooltip = document.getElementById('eventTooltip');
            tooltip.classList.remove('show');
            tooltipVisible = false;
        }

        function loadStickers() {
            fetch('Stickers/Rate.json')
                .then(response => {
                    if (!response.ok) throw new Error('Rate.json –Ω–µ –Ω–∞–π–¥–µ–Ω');
                    return response.json();
                })
                .then(data => {
                    lottie.loadAnimation({
                        container: document.getElementById('stickerContainer'),
                        renderer: 'svg',
                        loop: true,
                        autoplay: true,
                        animationData: data
                    });
                })
                .catch(error => {
                    document.getElementById('stickerContainer').innerHTML = 
                        '<div style="color:white;text-align:center;padding:20px;">‚ú®</div>';
                });
            
            fetch('Stickers/coins.json')
                .then(response => {
                    if (!response.ok) throw new Error('coins.json –Ω–µ –Ω–∞–π–¥–µ–Ω');
                    return response.json();
                })
                .then(data => {
                    lottie.loadAnimation({
                        container: document.getElementById('coinsIcon'),
                        renderer: 'svg',
                        loop: true,
                        autoplay: true,
                        animationData: data
                    });
                })
                .catch(error => {
                    document.getElementById('coinsIcon').innerHTML = 'üí∞';
                });
            
            fetch('Stickers/gamepad.json')
                .then(response => {
                    if (!response.ok) throw new Error('gamepad.json –Ω–µ –Ω–∞–π–¥–µ–Ω');
                    return response.json();
                })
                .then(data => {
                    lottie.loadAnimation({
                        container: document.getElementById('chibisIcon'),
                        renderer: 'svg',
                        loop: true,
                        autoplay: true,
                        animationData: data
                    });
                })
                .catch(error => {
                    document.getElementById('chibisIcon').innerHTML = 'üéÆ';
                });
        }

        function setupSelector() {
            const selectorItems = document.querySelectorAll('.selector-item');
            selectorItems.forEach(item => {
                item.addEventListener('click', function() {
                    const type = this.dataset.type;
                    
                    if (currentRatingType !== type) {
                        tg.HapticFeedback.impactOccurred('light');
                        
                        selectorItems.forEach(i => i.classList.remove('active'));
                        this.classList.add('active');
                        currentRatingType = type;
                        
                        renderCurrentRating();
                    }
                });
            });
        }

        function filterExcludedUsers(users) {
            return users.filter(user => {
                const username = user.username ? user.username.toLowerCase() : '';
                return !EXCLUDED_USERS.includes(username);
            });
        }

        async function loadAllRatingData() {
            try {
                await Promise.all([
                    loadCoinsRating(),
                    loadChibisRating()
                ]);
                
                calculateUserRank();
                renderCurrentRating();
            } catch (error) {
                document.getElementById('ratingList').innerHTML = 
                    '<div class="empty-state">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ä–µ–π—Ç–∏–Ω–≥–∞</div>';
            }
        }

        async function loadCoinsRating() {
            try {
                const response = await fetch('https://chibi-bot-3d4x.onrender.com/get_coins_rating');
                
                if (response.ok) {
                    let data = await response.json();
                    coinsData = filterExcludedUsers(data);
                } else {
                    coinsData = [];
                }
            } catch (error) {
                coinsData = [];
            }
        }

        async function loadChibisRating() {
            try {
                const response = await fetch('https://chibi-bot-3d4x.onrender.com/get_chibis_rating');
                
                if (response.ok) {
                    let data = await response.json();
                    chibisData = filterExcludedUsers(data);
                } else {
                    chibisData = [];
                }
            } catch (error) {
                chibisData = [];
            }
        }

        function calculateUserRank() {
            const currentUser = tg.initDataUnsafe?.user;
            if (!currentUser) return;
            
            const currentUsername = currentUser.username ? currentUser.username.toLowerCase() : '';
            
            let coinsRank = 0;
            let chibisRank = 0;
            
            coinsData.forEach((user, index) => {
                if (user.username && user.username.toLowerCase() === currentUsername) {
                    coinsRank = index + 1;
                }
            });
            
            chibisData.forEach((user, index) => {
                if (user.username && user.username.toLowerCase() === currentUsername) {
                    chibisRank = index + 1;
                }
            });
            
            if (coinsRank > 0 && chibisRank > 0) {
                currentUserRank = Math.round((coinsRank + chibisRank) / 2);
            } else if (coinsRank > 0) {
                currentUserRank = coinsRank;
            } else if (chibisRank > 0) {
                currentUserRank = chibisRank;
            } else {
                currentUserRank = 0;
            }
            
            const rankBadge = document.getElementById('userRankBadge');
            const rankTooltip = document.getElementById('rankTooltip');
            
            if (currentUserRank > 0) {
                rankBadge.textContent = `#${currentUserRank}`;
                rankTooltip.textContent = `–¢—ã –Ω–∞ ${currentUserRank} –º–µ—Å—Ç–µ –≤ –æ–±—â–µ–º —Ä–µ–π—Ç–∏–Ω–≥–µ`;
            } else {
                rankBadge.textContent = '#?';
                rankTooltip.textContent = '–¢—ã –ø–æ–∫–∞ –Ω–µ –≤ —Ä–µ–π—Ç–∏–Ω–≥–µ';
            }
        }

        function renderCurrentRating() {
            if (currentRatingType === 'coins') {
                renderRating(coinsData.slice(0, 10), currentRatingType);
            } else {
                renderRating(chibisData.slice(0, 10), currentRatingType);
            }
        }

        function getDisplayName(player) {
            if (player.name && player.name.trim() !== '') {
                return player.name.trim();
            }
            if (player.username && player.username.trim() !== '') {
                return player.username.trim();
            }
            return '–ù–æ—É–Ω–µ–π–º';
        }

        function renderRating(players, type) {
            const ratingList = document.getElementById('ratingList');
            
            if (!players || players.length === 0) {
                ratingList.innerHTML = '<div class="empty-state">–†–µ–π—Ç–∏–Ω–≥ –ø–æ–∫–∞ –ø—É—Å—Ç</div>';
                return;
            }
            
            ratingList.innerHTML = '';
            
            players.forEach((player, index) => {
                const card = document.createElement('div');
                card.className = 'rating-card';
                
                if (index < 3) {
                    card.classList.add('top-three');
                }
                
                const username = player.username ? `@${player.username.trim()}` : '–ë–µ–∑ —é–∑–∞';
                const score = type === 'coins' ? player.coins || 0 : player.chibis_count || 0;
                const scoreIcon = type === 'coins' ? 'üí∞' : '‚ö°Ô∏è';
                const displayName = getDisplayName(player);
                
                card.innerHTML = `
                    <div class="position">${index + 1}</div>
                    <div class="user-info">
                        <div class="username">${displayName}</div>
                        <div class="user-id">${username}</div>
                    </div>
                    <div class="score">
                        ${scoreIcon} ${score.toLocaleString()}
                    </div>
                `;
                
                if (player.username && player.username.trim() !== '') {
                    card.addEventListener('click', function() {
                        tg.HapticFeedback.impactOccurred('light');
                        tg.openTelegramLink(`https://t.me/${player.username}`);
                    });
                } else {
                    card.style.cursor = 'default';
                }
                
                ratingList.appendChild(card);
            });
        }

        function goBack() {
            tg.HapticFeedback.impactOccurred('light');
            
            if (window.history.length > 1) {
                window.history.back();
            } else {
                tg.close();
            }
        }

        document.addEventListener('DOMContentLoaded', initTelegramApp);
    </script>
</body>
</html>
